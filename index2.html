<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<script
			type="text/javascript"
			src="https://unpkg.com/bsv@0.30.0/bsv.min.js"
		></script>
		<script src="https://www.moneybutton.com/moneybutton.js"></script>

		<title>ChainWriter</title>
	</head>
	<body>
		<div id="my-money-button"></div>
		<br />

		<script>
			const content = document.getElementById("inputText").value;
			const outputs = [
				{
					amount: "0",
					currency: "BSV",
					script: bsv.Script.buildSafeDataOut([
						content,
						"#{mySignature}",
						"#{myPubKey}",
						"#{myPaymail}",
					]).toAsmString(),
				},
			];
			moneyButton.render(div, {
				label: "sign",
				outputs,
				cryptoOperations: [
					{
						name: "mySignature",
						method: "sign",
						data: content,
						dataEncoding: "utf8",
						key: "identity", // default value
						algorithm: "bitcoin-signed-message", // default value
					},
					{
						name: "myPubKey",
						method: "public-key",
						key: "identity", // default value
					},
					{
						name: "myPaymail",
						method: "paymail",
					},
				],
				onPayment: (payment) => {
					let cryptoOperations = payment.cryptoOperations;
					console.log(cryptoOperations);
					console.log(`User signature for their content is ${cryptoOperations[0].value},
      the public key used is ${cryptoOperations[1].value}
      the paymail of the user is ${cryptoOperations[2].value},
      and everything was broadcasted in the tx: ${payment.txid}`);
				},
			});
		</script>
	</body>
</html>
